{% stylesheet %}
  /* Tailwind CSS Prefix Example */
  .twcss-carousel-container {
    @apply twcss-relative twcss-overflow-hidden twcss-w-full;
  }

  .twcss-carousel-slide {
    @apply twcss-w-full twcss-h-full twcss-absolute twcss-top-0 twcss-left-0 twcss-transition-transform twcss-duration-500;
  }

  .twcss-carousel-content {
    @apply twcss-absolute twcss-text-white;
  }
{% endstylesheet %}

<div class='twcss-carousel-container' data-carousel-speed='{{ section.settings.carousel_speed | times: 1000 }}'>
  {% for block in section.blocks %}
    <div
      class='twcss-carousel-slide'
      style='background-image: url({{ block.settings.image | image_url }}); background-size: cover;'
    >
      <div
        class='twcss-carousel-content twcss-p-{{ block.settings.container_padding }}'
        style='
          background-color: {{ block.settings.container_color }};
          color: {{ block.settings.title_color }};
          font-size: {{ block.settings.title_font_size }}px;
          {{ block.settings.container_position | replace: '-', ':' }}
        '
      >
        <div class='twcss-text-{{ block.settings.content_layout }}'>
          <h2 class='twcss-text-[{{ block.settings.title_font_size }}px] twcss-text-[{{ block.settings.title_color }}]'>
            {{ block.settings.title }}
          </h2>
          <p class='twcss-text-[{{ block.settings.subtitle_font_size }}px] twcss-text-[{{ block.settings.subtitle_color }}]'>
            {{ block.settings.subtitle }}
          </p>
          {% if block.settings.button_label != blank %}
            <a
              href='{{ block.settings.button_link }}'
              class='twcss-inline-block twcss-mt-4 twcss-px-4 twcss-py-2'
              style='font-size: {{ block.settings.button_font_size }}px; color: {{ block.settings.button_color }};'
            >
              {{ block.settings.button_label }}
            </a>
          {% endif %}
        </div>
      </div>
    </div>
  {% endfor %}

  <button class='twcss-absolute twcss-left-0 twcss-top-1/2 twcss-transform -twcss-translate-y-1/2 twcss-z-10 twcss-bg-black twcss-text-white twcss-p-2'>
    ←
  </button>
  <button class='twcss-absolute twcss-right-0 twcss-top-1/2 twcss-transform -twcss-translate-y-1/2 twcss-z-10 twcss-bg-black twcss-text-white twcss-p-2'>
    →
  </button>
</div>

<script>
  const carousel = document.querySelector('.twcss-carousel-container');
  const slides = carousel.querySelectorAll('.twcss-carousel-slide');
  const speed = parseInt(carousel.dataset.carouselSpeed, 10);
  let index = 0;
  setInterval(() => {
    slides.forEach((slide, i) => {
      slide.style.transform = `translateX(${(i - index) * 100}%)`;
    });
    index = (index + 1) % slides.length;
  }, speed);
</script>

{% schema %}
{
  "name": "Featured Carousel",
  "tag": "section",
  "class": "featured-carousel-section",
  "settings": [
    {
      "type": "range",
      "id": "carousel_speed",
      "label": "Carousel Speed (seconds)",
      "min": 1,
      "max": 30,
      "step": 1,
      "default": 10
    }
  ],
  "blocks": [
    {
      "type": "image_block",
      "name": "Image Block",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "select",
          "id": "container_size",
          "label": "Container Size",
          "default": "medium",
          "options": [
            { "label": "Small", "value": "small" },
            { "label": "Medium", "value": "medium" },
            { "label": "Large", "value": "large" }
          ]
        },
        {
          "type": "color",
          "id": "container_color",
          "label": "Container Color",
          "default": "#ffffff"
        },
        {
          "type": "select",
          "id": "container_position",
          "label": "Container Position",
          "default": "middle-center",
          "options": [
            { "label": "Top Left", "value": "top-left" },
            { "label": "Top Center", "value": "top-center" },
            { "label": "Top Right", "value": "top-right" },
            { "label": "Middle Left", "value": "middle-left" },
            { "label": "Middle Center", "value": "middle-center" },
            { "label": "Middle Right", "value": "middle-right" },
            { "label": "Bottom Left", "value": "bottom-left" },
            { "label": "Bottom Center", "value": "bottom-center" },
            { "label": "Bottom Right", "value": "bottom-right" }
          ]
        },
        {
          "type": "select",
          "id": "mobile_container_position",
          "label": "Mobile Container Position",
          "default": "middle",
          "options": [
            { "label": "Top", "value": "top" },
            { "label": "Middle", "value": "middle" },
            { "label": "Bottom", "value": "bottom" }
          ]
        },
        {
          "type": "range",
          "id": "container_padding",
          "label": "Container Padding (px)",
          "min": 0,
          "max": 100,
          "step": 4,
          "default": 20
        },
        {
          "type": "select",
          "id": "content_layout",
          "label": "Content Layout",
          "default": "center",
          "options": [
            { "label": "Left", "value": "left" },
            { "label": "Center", "value": "center" },
            { "label": "Right", "value": "right" }
          ]
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Sample Title"
        },
        {
          "type": "range",
          "id": "title_font_size",
          "label": "Title Font Size (px)",
          "min": 12,
          "max": 64,
          "step": 2,
          "default": 32
        },
        {
          "type": "color",
          "id": "title_color",
          "label": "Title Color",
          "default": "#000000"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Subtitle",
          "default": "Sample Subtitle"
        },
        {
          "type": "range",
          "id": "subtitle_font_size",
          "label": "Subtitle Font Size (px)",
          "min": 12,
          "max": 48,
          "step": 2,
          "default": 20
        },
        {
          "type": "color",
          "id": "subtitle_color",
          "label": "Subtitle Color",
          "default": "#333333"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button Label",
          "default": "Learn More"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button Link"
        },
        {
          "type": "range",
          "id": "button_font_size",
          "label": "Button Font Size (px)",
          "min": 10,
          "max": 32,
          "step": 1,
          "default": 16
        },
        {
          "type": "color",
          "id": "button_color",
          "label": "Button Color",
          "default": "#ffffff"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Featured Carousel",
      "blocks": [
        {
          "type": "image_block",
          "settings": {
            "title": "Big Sale",
            "subtitle": "Up to 50% off",
            "button_label": "Shop Now",
            "container_position": "middle-center"
          }
        },
        {
          "type": "image_block",
          "settings": {
            "title": "New Arrivals",
            "subtitle": "Check out our latest styles",
            "button_label": "Browse",
            "container_position": "bottom-left"
          }
        }
      ]
    }
  ]
}
{% endschema %}
